# 数论问题 - 约瑟夫置换

## 约瑟夫置换（约瑟夫环）简介

> 弗拉维奥·约瑟夫在日记中写到：我和我的 40 名战友被罗马军队包围，为了荣耀，我们决定以抽签的方式自杀。

$n$ 个人围城一圈，每隔 $m$ 个人淘汰一人，依次往复，求最后剩下的一人的编号。

## 算法

- 输入：人数 $n$, 每隔 $m$ 淘汰一人。
- 输出：最终活下来的人的编号（人员编号为 [0, n]）。

解决约瑟夫置换问题固然可以使用模拟法，单为了更高效地解决问题，这里采用数学方法，推导出最后存活的人的编号在初始时数组内的位置：

1. 最后一轮，假设存活下来的人的编号为 $k$, 此时只剩下存活下的人，他的 $pos$ 为 0.
2. 倒数第二轮，编号为 $k$ 的人也是安全的，此时总人数为 2, $k$ 的位置 $pos$ 为 (0 + m) % 2.
3. 倒数第三轮，编号为 $k$ 的人也是安全的，此时总人数为 3, $k$ 的位置 $pos$ 为 (((0 + m) % 2) + m) % 3.
4. ...
5. 第一轮，编号为 $k$ 的人也是安全的，此时总人数为 n, $k$ 的位置 $pos$ 为 (pre_pos + m) % n.

综上，有 $f(n, m) = (f(n - 1, m \% n) + m) \%  n$ 及 $f(1,m) = 0$

## 示例

假设输入 $n$ 为 5, $m$ 为 2.

首先，模拟出最后存活的编号：

1. 开始时，人数为 0, 1, 2, 3, 4, 从 0 开始计数；
2. 第一轮结束后，编号 1 淘汰，剩余为 0, 2, 3, 4, 从 2 开始计数；
3. 第二轮结束后，编号 3 淘汰，剩余为 0, 2, 4, 从 4 开始计数；
4. 第三轮结束后，编号 0 淘汰，剩余为 2, 4, 从 2 开始计数；
5. 第四轮结束后，编号 4 淘汰，剩余为 2, 结束。

随后，验证算法：

1. 最后一轮，存活的人员总数为 1, 此时 $pos$ 为 0.
2. 倒数第二轮，编号 2 是安全的，此时总人数为 2, 编号 2 的 $pos$ 为 (0 + 2) % 2 = 0.
3. 倒数第三轮，编号 2 是安全的，此时总人数为 3, 编号 2 的 $pos$ 为 (0 + 2) % 3 = 2.
4. 倒数第四轮，编号 2 是安全的，此时总人数为 4, 编号 2 的 $pos$ 为 (2 + 2) % 4 = 0.
5. 倒数第五轮（即第一轮），编号 2 是安全的，此时总人数为 5, 编号 2 的 $pos$ 为 (0 + 2) % 5 = 2.

## 实现

[约瑟夫置换的数学实现](./mod.rs)

## 性能

## 练习

- [找到游戏的获胜者](https://leetcode-cn.com/problems/find-the-winner-of-the-circular-game/solution/)
- [圆圈中最后剩下的数字](https://leetcode-cn.com/problems/yuan-quan-zhong-zui-hou-sheng-xia-de-shu-zi-lcof/)

## 参考

- [Concrete Mathematics Chapter 1.3](https://www.csie.ntu.edu.tw/~r97002/temp/Concrete%20Mathematics%202e.pdf)
